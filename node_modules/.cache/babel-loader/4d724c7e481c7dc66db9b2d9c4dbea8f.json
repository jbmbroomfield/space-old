{"ast":null,"code":"import Path from './Path';\nimport Vector from './Vector';\n\nfunction getPosition(p0, p1, t) {\n  const term1 = Vector.multiply(1 - t, p0);\n  const term2 = Vector.multiply(t, p1);\n  return Vector.add(term1, term2);\n}\n\nclass Bezier extends Path {\n  constructor(startTime, endTime, ...points) {\n    super();\n    this.startTime = startTime;\n    this.endTime = endTime;\n\n    if (points.length === 1) {\n      this.initial = points[0];\n      this.final = points[0];\n    } else {\n      this.initial = new Bezier(startTime, endTime, ...points.slice(0, points.length - 1));\n      this.final = new Bezier(startTime, endTime, ...points.slice(1, points.length));\n    }\n  }\n\n  position(time) {\n    if (time < this.startTime) {\n      time = this.startTime;\n    }\n\n    if (time > this.endTime) {\n      time = this.endTime;\n    }\n\n    const t = (time - this.startTime) / (this.endTime - this.startTime);\n    return this.position_by_t(t);\n  }\n\n  position_by_t(t) {\n    if (this.initial === this.final) {\n      return this.initial;\n    }\n\n    const p0 = this.initial.position_by_t(t);\n    const p1 = this.final.position_by_t(t);\n    return getPosition(p0, p1, t);\n  }\n\n  get initialVelocity() {\n    return this.velocity(this.startTime);\n  }\n\n  get initialSpeed() {\n    return this.speed(this.startTime);\n  }\n\n  get finalVelocity() {\n    return this.velocity(this.endTime);\n  }\n\n  get finalSpeed() {\n    return this.speed(this.endTime - 1);\n  }\n\n  get maxSpeed() {\n    let return_value = 0;\n\n    for (let time = this.startTime; time <= this.endTime; time++) {\n      return_value = Math.max(return_value, this.speed(time));\n    }\n\n    return return_value;\n  }\n\n  static newLinearFromEndTime(source, destination, startTime, endTime) {\n    const p0 = [...source.position(startTime)];\n    const p1 = [...destination.position(endTime)];\n    return new this(startTime, endTime, p0, p1);\n  }\n\n  static newQuadraticFromEndTime(source, destination, startTime, endTime) {\n    const duration = endTime - startTime;\n    const p0 = source.position(startTime);\n    const initialV = source.velocity(startTime);\n    const p0p1 = Vector.multiply(duration / 2, initialV);\n    const p1 = Vector.add(p0, p0p1);\n    const p2 = destination.position(endTime);\n    return new this(startTime, endTime, p0, p1, p2);\n  }\n\n  static newCubicFromEndTime(source, destination, startTime, endTime) {\n    const duration = endTime - startTime;\n    const p0 = source.position(startTime);\n    const p1 = this.outgoingPoint(source, startTime, duration);\n    const p3 = destination.position(endTime);\n    const p2 = this.incomingPoint(destination, endTime, duration);\n    const p15 = this.outgoingPoint(source, startTime + 200, duration);\n    const p175 = this.incomingPoint(destination, endTime - 200, duration); // const p11 = Vector.add(p1, Vector.multiply(5, p0p1))\n    // const p21 = Vector.subtract(p2, Vector.multiply(5, p2p3))\n    // const p15 = Vector.multiply(0.5, Vector.add(p11, p21))\n\n    return new this(startTime, endTime, p0, p1, p15, p175, p2, p3);\n  }\n\n  static outgoingPoint(source, startTime, duration) {\n    const p0 = source.position(startTime);\n    const initialV = source.velocity(startTime);\n    const p0p1 = Vector.multiply(duration / 3, initialV);\n    return Vector.add(p0, p0p1);\n  }\n\n  static incomingPoint(destination, endTime, duration) {\n    const p3 = destination.position(endTime);\n    const finalV = destination.velocity(endTime);\n    const p2p3 = Vector.multiply(duration / 3, finalV);\n    return Vector.subtract(p3, p2p3);\n  }\n\n}\n\nexport default Bezier;","map":{"version":3,"sources":["/home/jim/projects/space/src/classes/Bezier.js"],"names":["Path","Vector","getPosition","p0","p1","t","term1","multiply","term2","add","Bezier","constructor","startTime","endTime","points","length","initial","final","slice","position","time","position_by_t","initialVelocity","velocity","initialSpeed","speed","finalVelocity","finalSpeed","maxSpeed","return_value","Math","max","newLinearFromEndTime","source","destination","newQuadraticFromEndTime","duration","initialV","p0p1","p2","newCubicFromEndTime","outgoingPoint","p3","incomingPoint","p15","p175","finalV","p2p3","subtract"],"mappings":"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","sourcesContent":["import Path from './Path'\nimport Vector from './Vector'\n\nfunction getPosition(p0, p1, t) {\n    const term1 = Vector.multiply(1 - t, p0)\n    const term2 = Vector.multiply(t, p1)\n    return Vector.add(term1, term2)\n}\n\nclass Bezier extends Path {\n\n    constructor(startTime, endTime, ...points) {\n        super()\n        this.startTime = startTime\n        this.endTime = endTime\n        if (points.length === 1) {\n            this.initial = points[0]\n            this.final = points[0]\n        } else {\n            this.initial = new Bezier(startTime, endTime, ...points.slice(0, points.length - 1))\n            this.final = new Bezier(startTime, endTime, ...points.slice(1, points.length))\n        }\n    }\n\n    position(time) {\n        if (time < this.startTime) {\n            time = this.startTime\n        }\n        if (time > this.endTime) {\n            time = this.endTime\n        }\n        const t = (time - this.startTime) / (this.endTime - this.startTime)\n        return this.position_by_t(t)\n    }\n\n    position_by_t(t) {\n        if (this.initial === this.final) {\n            return this.initial\n        }\n        const p0 = this.initial.position_by_t(t)\n        const p1 = this.final.position_by_t(t)\n        return getPosition(p0, p1, t)\n    }\n\n    get initialVelocity() {\n        return this.velocity(this.startTime)\n    }\n\n    get initialSpeed() {\n        return this.speed(this.startTime)\n    }\n\n    get finalVelocity() {\n        return this.velocity(this.endTime)\n    }\n\n    get finalSpeed() {\n        return this.speed(this.endTime - 1)\n    }\n\n    get maxSpeed() {\n        let return_value = 0\n        for (let time = this.startTime; time <= this.endTime; time++) {\n            return_value = Math.max(return_value, this.speed(time))\n        }\n        return return_value\n    }\n\n    static newLinearFromEndTime(source, destination, startTime, endTime) {\n        const p0 = [...source.position(startTime)]\n        const p1 = [...destination.position(endTime)]\n        return new this(startTime, endTime, p0, p1)\n    }\n\n    static newQuadraticFromEndTime(source, destination, startTime, endTime) {\n        const duration = endTime - startTime\n        const p0 = source.position(startTime)\n        const initialV = source.velocity(startTime)\n        const p0p1 = Vector.multiply(duration / 2, initialV)\n        const p1 = Vector.add(p0, p0p1)\n        const p2 = destination.position(endTime)\n        return new this(startTime, endTime, p0, p1, p2)\n    }\n\n    static newCubicFromEndTime(source, destination, startTime, endTime) {\n        const duration = endTime - startTime\n        const p0 = source.position(startTime)\n        const p1 = this.outgoingPoint(source, startTime, duration)\n        const p3 = destination.position(endTime)\n        const p2 = this.incomingPoint(destination, endTime, duration)\n        const p15 = this.outgoingPoint(source, startTime + 200, duration)\n        const p175 = this.incomingPoint(destination, endTime - 200, duration)\n        // const p11 = Vector.add(p1, Vector.multiply(5, p0p1))\n        // const p21 = Vector.subtract(p2, Vector.multiply(5, p2p3))\n        // const p15 = Vector.multiply(0.5, Vector.add(p11, p21))\n        return new this(startTime, endTime, p0, p1, p15, p175, p2, p3)\n\n    }\n\n    static outgoingPoint(source, startTime, duration) {\n        const p0 = source.position(startTime)\n        const initialV = source.velocity(startTime)\n        const p0p1 = Vector.multiply(duration / 3, initialV)\n        return Vector.add(p0, p0p1)\n    }\n\n    static incomingPoint(destination, endTime, duration) {\n        const p3 = destination.position(endTime)\n        const finalV = destination.velocity(endTime)\n        const p2p3 = Vector.multiply(duration / 3, finalV)\n        return Vector.subtract(p3, p2p3)\n    }\n\n\n\n}\n\nexport default Bezier"]},"metadata":{},"sourceType":"module"}